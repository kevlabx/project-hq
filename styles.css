/* ============================
   MATRIX THEME — TOKENS
   ============================ */
:root{
  --bg:#0b1310;
  --panel:#0f1a16;
  --panel-2:#0d1814;
  --text:#e7f5ee;
  --muted:#a7c8bb;
  --line:#1f2d27;
  --ring:#08e07f;

  --accent-green:#00ff85;
  --accent-amber:#f7b955;
  --accent-crimson:#f36c6c;
  --accent-cyan:#46dbff;

  --grad-green: linear-gradient(90deg,#00ff85,#46dbff);
  --glow:0 0 12px rgba(0,255,133,.35);
  --radius:16px;
  --focus:#93ffe0;
  --shadow:0 6px 24px rgba(0,0,0,.25),0 2px 8px rgba(0,0,0,.15);
}

html[data-contrast="normal"]{
  --muted:#9bb7aa;
  --line:#183027;
}

html[data-theme="light"]{
  --bg:#f7faf8;
  --panel:#ffffff;
  --panel-2:#f4f8f6;
  --text:#102219;
  --muted:#4a6a5c;
  --line:#dfe7e3;
  --ring:#0a8f55;

  --accent-green:#0a8f55;
  --accent-amber:#b4771d;
  --accent-crimson:#a94444;
  --accent-cyan:#2b7e96;

  --grad-green: linear-gradient(90deg,#0a8f55,#2b7e96);
  --shadow:0 6px 24px rgba(0,0,0,.10),0 2px 8px rgba(0,0,0,.06);
}

html[data-theme="console"]{
  --bg:#040404;
  --panel:#060606;
  --panel-2:#050505;
  --text:#c0ffd6;
  --muted:#78b697;
  --line:#0f2b1e;
  --ring:#15ff9a;

  --accent-green:#15ff9a;
  --accent-amber:#caa84a;
  --accent-crimson:#ff6e6e;
  --accent-cyan:#5cd7ff;

  --grad-green: linear-gradient(90deg,#15ff9a,#5cd7ff);
  --shadow:0 0 0 rgba(0,0,0,0);
}

/* ============================
   BASE
   ============================ */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font:14px/1.5 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
a{color:inherit}

.small{font-size:14px}
.muted{color:var(--muted)}
.h2{font-size:18px;font-weight:800;margin:0 0 8px}

/* ============================
   HEADER / NAV
   ============================ */
.site-header{
  max-width:1240px;
  margin:18px auto 12px;
  padding:0 18px;
  display:grid;
  grid-template-columns:auto 1fr;
  grid-template-areas:
    "brand actions"
    "nav nav";
  align-items:center;
  gap:10px;
}

.site-header .brand{grid-area:brand}
.brand .logo{
  display:inline-flex; width:28px; height:28px; border-radius:50%;
  background:#072116; color:#afffdd; align-items:center; justify-content:center;
  font-weight:700; margin-right:8px;
}
.brand .title{font-size:18px; font-weight:800; display:inline-block; margin-right:8px}
.brand .subtitle{margin-top:4px}

.site-header .nav{
  grid-area:nav;
  display:flex; flex-wrap:wrap; gap:8px; justify-content:center;
}
.site-header .actions{
  grid-area:actions;
  display:flex; flex-wrap:wrap; gap:8px; justify-content:flex-end;
}

.actions .menu{position:relative}
.menu-panel{
  display:none;
  position:absolute; top:36px; right:0;
  background:var(--panel); border:1px solid var(--line);
  border-radius:var(--radius); padding:10px;
  box-shadow:var(--shadow); min-width:220px; z-index:20;
}
.menu.open .menu-panel{display:block}
.menu .row{display:flex; align-items:center; gap:8px; padding:6px 2px}

/* Operator HUD */
.operator{
  grid-column:1 / -1;
  margin-top:6px;
  color:var(--muted);
  font-size:13px;
  padding:6px 10px;
  border:1px dashed var(--line);
  border-radius:12px;
  background:var(--panel-2);
}

/* ============================
   BUTTONS
   ============================ */
.pill{
  background:transparent; border:1px solid var(--line); color:var(--text);
  padding:6px 10px; border-radius:999px; cursor:pointer; font:inherit;
  transition:border-color .15s, background-color .15s;
}
.pill:hover{border-color:var(--accent-cyan)}
.pill.active{background:rgba(70,219,255,.08); border-color:var(--accent-cyan)}
.pill.danger{border-color:var(--accent-crimson); color:var(--accent-crimson)}
.pill:focus{outline:2px solid var(--focus); outline-offset:2px}
/* Red/Blue pills */
.pill.red{background:linear-gradient(0deg,rgba(255,0,0,.12),transparent); border-color:#ff6868}
.pill.blue{background:linear-gradient(0deg,rgba(0,128,255,.12),transparent); border-color:#6fb9ff}

/* Circuit day pills (show % ring) */
.pill[data-day]{position:relative; padding-left:26px; padding-right:10px}
.pill[data-day]::before{
  content:""; position:absolute; left:8px; top:50%; transform:translateY(-50%);
  width:12px; height:12px; border-radius:50%; border:1px solid var(--line);
  background:conic-gradient(var(--accent-green) calc(var(--pct,0)*1%), transparent 0);
  box-shadow:var(--glow);
}

/* Plain buttons */
.btn{
  background:transparent; border:1px solid var(--line); color:var(--text);
  padding:8px 12px; border-radius:10px; cursor:pointer; font:inherit;
  transition:border-color .15s, background-color .15s;
}
.btn:hover{border-color:var(--accent-green)}
.btn.primary{background:linear-gradient(0deg,rgba(10,143,85,.12),transparent); border-color:var(--accent-green)}
.btn:focus{outline:2px solid var(--focus); outline-offset:2px}

/* ============================
   MAIN / PANELS
   ============================ */
.site-main{max-width:1240px; margin:20px auto; padding:0 18px}
.panel{
  background:var(--panel); border:1px solid var(--line);
  border-radius:var(--radius); padding:16px; box-shadow:var(--shadow); margin-bottom:14px;
}
.panel .toolbar{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px}

.code{
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  white-space: pre-wrap; background:var(--panel-2);
  border:1px dashed var(--line); border-radius:12px; padding:10px;
}

/* Matrix divider */
.panel + .panel::before{
  content:""; display:block; height:10px; margin:10px 0 6px 0;
  background: repeating-linear-gradient(90deg, rgba(0,255,133,.2) 0 2px, transparent 2px 4px);
  mask-image: linear-gradient(to bottom, rgba(0,0,0,.7), transparent);
}

/* Cards & lists */
.grid{display:grid; gap:12px}
.grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
.grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
@media(max-width:980px){.grid.cols-3{grid-template-columns:repeat(2,minmax(0,1fr))}}
@media(max-width:720px){.grid.cols-2,.grid.cols-3{grid-template-columns:1fr}}

.card{background:var(--panel-2); border:1px solid var(--line); border-radius:14px; padding:12px}
.list{display:flex; flex-direction:column; gap:8px}
.day-card{
  display:flex; align-items:center; justify-content:space-between;
  background:var(--panel); border:1px solid var(--line); border-radius:12px; padding:10px;
}
.badge{padding:2px 8px; border:1px solid var(--line); border-radius:999px}

/* Micro progress bar */
.tinybar{height:6px; border-radius:6px; background:#0d241c; border:1px solid #16382c; overflow:hidden; margin-top:8px}
.tinybar>i{display:block; height:100%; background:var(--grad-green); width:0%}

/* ============================
   CONSTRUCT HUB (radial)
   ============================ */
.construct-hub{display:block}
.construct{
  --size: 260px;
  position:relative; width:var(--size); height:var(--size); margin:0 auto;
}
.core-ring{
  --pct:0; position:absolute; inset:0; border-radius:50%;
  background:
    radial-gradient(closest-side, transparent calc(50% - 10px), var(--panel) calc(50% - 10px)),
    conic-gradient(var(--accent-green) calc(var(--pct)*1%), transparent 0);
  box-shadow: var(--glow);
}
.orbit{position:absolute; inset:0}
.node{
  position:absolute; left:50%; top:50%;
  transform: rotate(var(--angle,0deg)) translate(calc(var(--size)/2.6)) rotate(calc(var(--angle,0deg)*-1));
  width:24px; height:24px; border:1px solid var(--line); border-radius:50%; background:var(--panel-2);
  box-shadow: var(--glow); cursor:pointer;
}
.node::after{
  content:""; position:absolute; inset:2px; border-radius:50%;
  background: conic-gradient(var(--accent-green) calc(var(--pct,0)*1%), transparent 0);
}
.node:focus{outline:2px solid var(--focus); outline-offset:2px}

/* Legend chips */
.construct-legend{display:flex; gap:8px; justify-content:center; margin-top:10px}
.chip{border:1px solid var(--line); border-radius:999px; padding:2px 8px; font-size:12px}
.chip.ok{border-color:var(--accent-green); color:var(--accent-green)}

/* ============================
   INTEL CARDS
   ============================ */
.intel .label{
  font-size:12px; color:var(--muted); letter-spacing:.08em
}
.intel .intel-body{min-height:48px}

/* ============================
   PACKETS (Prompts)
   ============================ */
.packet{
  border:1px solid var(--line); border-radius:14px; padding:10px;
  background:linear-gradient(0deg,rgba(0,255,133,.05),transparent);
}
.packet .packet-title{
  font-size:12px; color:var(--muted);
  display:flex; align-items:center; gap:6px; margin-bottom:6px;
}
.packet .code{border-style:solid; border-color:#124733}

/* ============================
   FOOTER
   ============================ */
.site-footer{
  max-width:1240px; margin:0 auto 28px; padding:0 18px; color:var(--muted);
  display:flex; justify-content:space-between; gap:10px;
}

/* ============================
   FOCUS (Jack-in)
   ============================ */
body.jackin .site-header .nav{opacity:.25; pointer-events:none}
body.jackin .site-footer{opacity:.25; pointer-events:none}
body.jackin .site-main{filter:grayscale(.15) brightness(.98)}
body.jackin #btn-jack{background:#102718; border-color:#1f513e}
@media (prefers-reduced-motion:no-preference){
  body.jackin .site-main{
    background-image:
      radial-gradient(100px 20px at 10% 20%, rgba(0,255,133,.05), transparent 70%),
      radial-gradient(120px 22px at 80% 70%, rgba(70,219,255,.05), transparent 70%);
    background-attachment:fixed;
  }
}

/* ============================
   TOASTS
   ============================ */
.toast{
  background:#11231c; border:1px solid #1f3c32; color:#ccffe9;
  padding:10px 12px; border-radius:10px; transition:opacity .25s; box-shadow:var(--shadow)
}
#toasts{position:fixed; right:18px; bottom:18px; display:flex; flex-direction:column; gap:10px; z-index:2000}

/* ============================
   TERMINAL (command palette)
   ============================ */
.terminal.hidden{display:none}
.terminal{
  position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.5); z-index:3000;
}
.terminal-box{
  width:min(720px,94vw); background:var(--panel); border:1px solid var(--line);
  border-radius:16px; box-shadow:var(--shadow)
}
.terminal-header{display:flex; justify-content:space-between; align-items:center; padding:10px 12px; border-bottom:1px solid var(--line)}
.terminal-body{padding:12px; max-height:min(60vh,560px); overflow:auto; background:var(--panel-2)}
.crt{color:#afffdd; text-shadow:0 0 4px rgba(0,255,133,.35)}

/* ============================
   UTILITIES
   ============================ */
.center{display:flex; align-items:center; justify-content:center}
.right{margin-left:auto}
.space{height:8px}

/* CHECKLISTS */
.panel input[type="checkbox"]{margin-right:6px}
.panel input[type="checkbox"]:focus{outline:2px solid var(--focus)}
.panel input[type="checkbox"]:checked + span{text-decoration:line-through; opacity:.7}

/* Safety: default display for any “dashboard-only” placeholders if present */
[data-view="dashboard-only"]{display:block}
